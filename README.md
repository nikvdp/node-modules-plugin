combination of https://github.com/zsh-users/zsh/blob/master/Functions/Misc/add-zsh-hook

and 

https://gist.github.com/puffnfresh/4151775
